# CVE-2019-5418 File Content Disclosure Vulnerability

## victim:

The victim contains a ruby docker image running a Rails app from https://github.com/mpgn/CVE-2019-5418/tree/master/demo. It contains the corresponding vulnerable application controller on <ip>:3000/chybeta

## normal:

The normal behaviour consists of a random surfer. It iterates through all available links on the current website and picks and clicks one randomly. 

## exploit:

The exploit uses the vulnerable ApplicationController through header manipulation and extracts /etc/passwd.

Further Reading:
- https://nvd.nist.gov/vuln/detail/CVE-2019-5418
- https://github.com/mpgn/CVE-2019-5418
- https://groups.google.com/g/rubyonrails-security/c/pFRKI96Sm8Q
- https://chybeta.github.io/2019/03/16/Analysis-for%E3%80%90CVE-2019-5418%E3%80%91File-Content-Disclosure-on-Rails/

## cli:

    sudo python3 main.py a b c
    
    a: boolean (0/1) run automated normal behavior
    b: integer recording time
       1-n: recording time in seconds
        -1: flag to run auto stop of recording after end of exploit
    c: boolean (0/1) run automated exploit