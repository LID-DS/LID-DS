# CVE-2017-12635_6 CouchDB-Scenario

## Description / Overview of scenario
Running CouchDB server with remote code execution and possible privilege escalation listed as CVE-2017-12635 and CVE-2017-12636.
First the privilege escalation is used to get admin rights and with these rights configurations can be made to enable remote code execution.
Two different forms of attacks accessible with fourth parameter (python main.py 4 20 1 0), 0 indicates no valid user is needed to create documents.
1 indidicates the need of a valid user which will be brute-forced.

## victim:
Running vulhub couchDB docker. See: https://github.com/vulhub/vulhub/tree/master/couchdb/CVE-2017-12635

## normal:
Create, update, read and delete documents in database. Logins and bad logins to couchDB.  

## exploit:

#### Portscan

Using nmap to scan ports for running couchDB. 

#### Brute-Force

Using hydra in combination with [rockyou](https://github.com/praetorian-inc/Hob0Rules/blob/master/wordlists/rockyou.txt.gz) password list.
(valid user credentials are moved to beginning of list). 

#### Privilege-Escalation

Using CVE-2017-12635 - Modifying database user to have admin rights with changing roles of user through vulnerability in JSON-Parser.

#### Remote-Code-Execution

Using CVE-2017-12636 - Misconfiguration in Query-Servers gives possibility to open reverse shell.

## cli:

    sudo python3 main.py a b c d
    
    a: boolean (0/1) run automated normal behavior
    b: integer recording time
       1-n: recording time in seconds
        -1: flag to run auto stop of recording after end of exploit
    c: boolean (0/1) run automated exploit
    d: boolean (0/1) run full chain exploit