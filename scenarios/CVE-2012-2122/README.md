# CVE-2012-2122 Improperly checked token comparison leads to root database access with wrong password

## Description / Overview of scenario
Oracle MySQL, when running in certain environments with certain implementations of the memcmp function, allows remote attackers to bypass authentication by repeatedly authenticating with the same incorrect password, which eventually causes a token comparison to succeed due to an improperly-checked return value.

## victim:
The victim is a docker container directly taken from vulhub including the corresponding vulnerability. More information at https://github.com/vulhub/vulhub.

## normal:
The normal behaviour logs in to the database as user and then performs random SQL statements like INSERT and SELECT.

## exploit:
The exploit works by repeatedly trying to log in as root to the mysql console. Because of the vulnerablity the login with a wrong password works with a certain probability, when the login succeeds the exploit stops logging in.

Further information:
* https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2012-2122

## cli:
There are two additional parameters when an exploit shall be recorded:

        sudo python3 main.py a b c d e

        a:boolean (0/1) run automated normal behavior
        b:integer recording time
        c:boolean (0/1) run automated exploit
        d:character attacking speed
          n = normal speed, no sleep
          s = slow speed, sleep 1 second after every login attempt
          v = very slow speed, sleep 5 seconds after every login attempt
        e:boolean (0/1) extract credentials

        note: if no exploit shall be executed params e and d do not need to be given

